import{_ as s}from"./Bm2Oy-cY.js";import{c as o,w as u,o as p,a as l,b as e}from"./YobvFIQM.js";const g={__name:"install-d8",setup(r){const t={title:"d8 安装手记",description:"安装 d8 踩的一些坑",keywords:"原创,V8",pathname:"install-d8",translation:null,create_time:"2020-04-19",prev:{title:"某官网开发手记",pathname:"relection-on-static-sites-development"},next:{title:"Clean Code",pathname:"clean-code"}};return(c,n)=>{const a=s;return p(),o(a,{data:t},{default:u(()=>[...n[0]||(n[0]=[l("p",null,[e("最近在看极客时间"),l("a",{href:"https://time.geekbang.org/column/intro/296",target:"_blank",rel:"noopener"},"《图解 Google V8》"),e("专栏，其中部分内容用到了 v8 的 debug 版本 "),l("code",null,"d8"),e(" 调试。之前也读过一些介绍 d8 调试的文章。于是有了在自己电脑上安装 d8 的想法。")],-1),l("h2",null,"自己动手",-1),l("p",null,[e("首先找到的是权威文档: "),l("a",{href:"https://gist.github.com/kevincennis/0cd2138c78a07412ef21",target:"_blank",rel:"noopener"},"Installing V8 on a Mac"),e("。走到拉取源码这一步时，变遇到了限制，源码库太大，下载太慢。")],-1),l("p",null,"这促使我想到了一个曲线救国的办法。使用阿里云 ECS，地域选择美国硅谷。并且我选择使用 docker 分阶段构建的方式，第一步编译 d8，第二步复制编译后的文件打入镜像中。",-1),l("p",null,"事实证明，源码下载速度上来了（感叹一句，国内程序员太难了）。但监控数据显示，刚创建的 2 核 4 G 的实例，CPU 使用率已飙升到 100%。我暗自庆幸，幸亏没有在自己电脑上编译，否则电脑还不得爆炸吗……",-1),l("p",null,"最终，整个编译耗费时间 100 余分钟。",-1),l("p",null,[l("img",{loading:"lazy",src:"https://p1.ssl.qhimg.com/t017441ab6f60c16928.jpg",alt:""})],-1),l("h2",null,"好用的 jsvu",-1),l("p",null,"就在等着编译完成的这段时间里，我还在持续搜索有没有其他更好的办法。难道大家真的要自己去编译吗？没有人提供一个下载即可用的二进制文件吗？",-1),l("p",null,"等啊等，找啊找，编译都快完成的时候，我发现了一个工具。这下我几个小时的工作，全白费了。",-1),l("p",null,[e("这个工具就是 GoogleChromeLabs 的 "),l("a",{href:"https://github.com/GoogleChromeLabs/jsvu",target:"_blank",rel:"noopener"},"jsvu"),e("。")],-1),l("p",null,"jsvu 是一个 JavaScript 引擎版本管理工具。其支持的引擎和操作系统如下 ——",-1),l("p",null,[l("img",{loading:"lazy",src:"https://p3.ssl.qhimg.com/t018daa32a5ac51563d.jpg",alt:""})],-1),l("p",null,"太强了！",-1),l("p",null,"jsvu 安装方法如下 ——",-1),l("ol",null,[l("li",null,[l("p",null,[e("全局安装 "),l("code",null,"jsvu"),e("： "),l("code",null,"npm install jsvu -g")])]),l("li",null,[l("p",null,[e("将"),l("code",null,"~/.jsvu"),e("路径添加到系统环境变量中："),l("code",null,'export PATH="${HOME}/.jsvu:${PATH}"')])]),l("li",null,[l("p",null,[e("执行 "),l("code",null,"jsvu"),e(" 命令通过命令行交互选择需要安装的 JS 引擎，如下图所示。")]),l("p",null,[e("也可以直接通过命令参数指定： "),l("code",null,"jsvu --os=mac64 --engines=v8-debug"),e("。")]),l("p",null,[l("img",{loading:"lazy",src:"https://s1.ssl.qhres2.com/static/d04b435008efe9db.svg",alt:""})])]),l("li",null,[l("p",null,[e("然后就可以愉快地使用 "),l("code",null,"v8-debug"),e("命令啦。")]),l("p",null,[l("img",{loading:"lazy",src:"https://s1.ssl.qhres2.com/static/06b5fb8d3442eec2.svg",alt:""})]),l("p",null,[e("当然，如果你更喜欢 "),l("code",null,"d8"),e("这个简单的命令，也可以执行 "),l("code",null,"cp ~/.jsvu/v8-debug ~/.jsvu/d8"),e(" 将 v8-debug 脚本复制一份。")])])],-1),l("blockquote",null,[l("p",null,[e("本文中命令行录屏图片是使用 "),l("a",{href:"https://asciinema.org/",target:"_blank",rel:"noopener"},"asciinema"),e(" 录制并通过 "),l("a",{href:"https://github.com/marionebl/svg-term-cli",target:"_blank",rel:"noopener"},"svg-term-cli"),e(" 转换为 SVG 的。")])],-1),l("h2",null,"其他",-1),l("p",null,[e("通过 jsvu 我们能够很方便地管理 JS 引擎，也能指定安装特定版本。另外，jsvu 的"),l("a",{href:"https://github.com/GoogleChromeLabs/jsvu",target:"_blank",rel:"noopener"},"文档"),e("中，还说明了 jsvu 如何与"),l("code",null,"eshost-cli"),e("集成使用，这样我们可以很方便地测试不同 JS 引擎的执行效率差异。")],-1)])]),_:1})}}};export{g as default};
