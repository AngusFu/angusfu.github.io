import{_ as o}from"./BPnFNyzh.js";import{_ as r}from"./Bm2Oy-cY.js";import{c as i,w as p,o as m,a,b as s,l as c}from"./YobvFIQM.js";import"./D-_IMEKP.js";const v={__name:"using-html-form-validation-in-pure-javascript",setup(u){const n={title:"[译] HTML 表单验证",description:"[translation]Using HTML Form Validation in Pure JavaScript, HTML 表单验证",keywords:"JavaScript,翻译",pathname:"using-html-form-validation-in-pure-javascript",translation:{author:"@Raymond Camden",social:"https://twitter.com/raymondcamden",from:"https://www.raymondcamden.com/2016/10/19/using-html-form-validation-in-pure-javascript"},create_time:"2016-11-05",prev:{title:"算法学习：选择排序",pathname:"algo-selection-sort"},next:{title:"算法学习：插入排序",pathname:"algo-insertion-sort"}};return(d,l)=>{const t=o,e=r;return m(),i(e,{data:n},{default:p(()=>[l[0]||(l[0]=a("p",null,[s("我是 "),a("a",{href:"https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Forms/Data_form_validation",target:"_blank",rel:"noopener"},"HTML 表单验证"),s("（HTML form validation） 的超级粉丝，因为它取代了我使用了近 20 年的 JavaScript 代码。不幸的是，"),a("a",{href:"http://caniuse.com/#feat=form-validation",target:"_blank",rel:"noopener"},"Safari"),s(" 并不支持这个特性（谈到 Web 时，先别跟我提 Apple 和他们的优先级）。")],-1)),a("p",null,[c(t,{src:"/caniuse/embed.html?feat=form-validation&periods=future_3,future_2,future_1,current,past_1,past_2,past_3,past_4,past_5"})]),l[1]||(l[1]=a("p",null,[s("不过，我确实很喜欢这个主意，将问题交给 HTML 自己解决。实际上，最近有个网站展示了许多类似的例子："),a("a",{href:"http://youmightnotneedjs.com/",target:"_blank",rel:"noopener"},"You Might Not Need JavaScript"),s("。如果还没看过，赶紧点开吧。这是一个极好的例子，展示了 HTML 和 CSS 可以如何取代我们使用了多年的 JavaScript 片段。")],-1)),l[2]||(l[2]=a("p",null,[s("基于上面这些，今天早上，我倒产生了另外一些差不多完全相反的想法。可以在纯 JavaScript 表单中使用基于 HTML 的表单验证么？答案是可以（当然，首先浏览器得支持）。假如我们可以使用 "),a("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement",target:"_blank",rel:"noopener"},"createElement"),s(" 动态创建 DOM 元素，那么能够在 JavaScript 代码中添加简便的 email 验证么？似乎可以：")],-1)),l[3]||(l[3]=a("pre",null,[a("code",{class:"hljs lang-javascript"},[a("span",{class:"hljs-keyword"},"var"),s(" element = "),a("span",{class:"hljs-variable language_"},"document"),s("."),a("span",{class:"hljs-title function_"},"createElement"),s("("),a("span",{class:"hljs-string"},"'input'"),s(`);
element.`),a("span",{class:"hljs-title function_"},"setAttribute"),s("("),a("span",{class:"hljs-string"},"'type'"),s(","),a("span",{class:"hljs-string"},"'email'"),s(`);
element.`),a("span",{class:"hljs-property"},"value"),s(" = "),a("span",{class:"hljs-string"},"'foo@foo.com'"),s(`;
`),a("span",{class:"hljs-variable language_"},"console"),s("."),a("span",{class:"hljs-title function_"},"log"),s("(element."),a("span",{class:"hljs-property"},"validity"),s("."),a("span",{class:"hljs-property"},"valid"),s(`); 
`)])],-1)),l[4]||(l[4]=a("p",null,"上面这段代码所做的工作是创建一个离线 input 元素（译者注：原文为 virtual input element，但译者认为 virtual 的说法似乎有些歧义，看看最近两年火爆的 virtual DOM，还敢叫说 createElement 创建出来的活生生的元素是 virtual elment 么？倒是让我想起 offline canvas，是故借用），将它的 type 属性设置为 email 并设置其 value 为某一个值。然后就打印出这个值的有效状态了。可以重写这段代码，封装成函数：",-1)),l[5]||(l[5]=a("pre",null,[a("code",{class:"hljs lang-javascript"},[a("span",{class:"hljs-keyword"},"var"),s(` elm;
`),a("span",{class:"hljs-keyword"},"function"),s(),a("span",{class:"hljs-title function_"},"isValidEmail"),s("("),a("span",{class:"hljs-params"},"s"),s(`) {
  `),a("span",{class:"hljs-keyword"},"if"),s(`(!elm) {
    elm = `),a("span",{class:"hljs-variable language_"},"document"),s("."),a("span",{class:"hljs-title function_"},"createElement"),s("("),a("span",{class:"hljs-string"},"'input'"),s(`);
    elm.`),a("span",{class:"hljs-title function_"},"setAttribute"),s("("),a("span",{class:"hljs-string"},"'type'"),s(", "),a("span",{class:"hljs-string"},"'email'"),s(`);
  }
  elm.`),a("span",{class:"hljs-property"},"value"),s(` = s;
  `),a("span",{class:"hljs-keyword"},"return"),s(" elm."),a("span",{class:"hljs-property"},"validity"),s("."),a("span",{class:"hljs-property"},"valid"),s(`;
}

`),a("span",{class:"hljs-variable language_"},"console"),s("."),a("span",{class:"hljs-title function_"},"log"),s("("),a("span",{class:"hljs-title function_"},"isValidEmail"),s("("),a("span",{class:"hljs-string"},"'foo'"),s(`));
`),a("span",{class:"hljs-variable language_"},"console"),s("."),a("span",{class:"hljs-title function_"},"log"),s("("),a("span",{class:"hljs-title function_"},"isValidEmail"),s("("),a("span",{class:"hljs-string"},"'goo@goo.com'"),s(`));
`),a("span",{class:"hljs-variable language_"},"console"),s("."),a("span",{class:"hljs-title function_"},"log"),s("("),a("span",{class:"hljs-title function_"},"isValidEmail"),s("("),a("span",{class:"hljs-string"},"'zoo'"),s(`)); 
`)])],-1)),l[6]||(l[6]=a("p",null,"我不太喜欢这段代码中引入了一个全局变量，不过这样可以缓存 DOM 元素，也还不错。如果封装在模块中，就将它保存在本地变量中吧。",-1)),l[7]||(l[7]=a("p",null,"还是那句话，代码在不支持 HTML 表单验证的浏览器中没法工作。但这确实非常简单，对吧？同样还可以用这种办法验证 URL 或者其他内容。不知亲爱的读者您对此作何评论？",-1)),l[8]||(l[8]=a("p",null,[s("可以在 JSBin 中运行代码看看效果： "),a("a",{href:"https://jsbin.com/diqepa/edit?js,console",target:"_blank",rel:"noopener"},"https://jsbin.com/diqepa/edit?js,console"),s("。")],-1)),l[9]||(l[9]=a("blockquote",null,[a("p",null,[s("若您喜欢本文, 可以看下我的 "),a("a",{href:"http://www.amazon.com/gp/registry/wishlist/2TCL1D08EZEYE/ref=cm_wl_rlist_go_v?",target:"_blank",rel:"noopener"},"Amazon Wishlist"),s(" 帮我实现愿望，或者"),a("a",{href:"https://paypal.me/RaymondCamden",target:"_blank",rel:"noopener"},"通过 PayPal 捐款支持我"),s("。还可以"),a("a",{href:"https://feedburner.google.com/fb/a/mailverify?uri=RaymondCamdensBlog",target:"_blank",rel:"noopener"},"订阅邮件推送"),s("获取最新信息。")])],-1))]),_:1})}}};export{v as default};
