import{_ as t}from"./BV7Yc4PX.js";import{c as o,w as r,o as s,a as l,b as n}from"./B1kHp8qp.js";import"./8oskhlv7.js";const m={__name:"velocity-2016-note-1",setup(a){const i={title:"笔记：velocity 2016 第一天",description:"velocity 2016 笔记",keywords:"原创,笔记",pathname:"velocity-2016-note-1",translation:null,create_time:"2016-12-01",prev:{title:"笔记：velocity 2016 第二天",pathname:"velocity-2016-day-2"},next:{title:"[译] CSS 方法论的选择",pathname:"when-to-use-which-css-methodology"}};return(c,u)=>{const e=t;return s(),o(e,{data:i},{default:r(()=>[...u[0]||(u[0]=[l("p",null,[n("有幸得到老大给的 Velocity 大会门票，屁颠屁颠跑去听分享。下面是今天（第一天）的笔记。记得比较简略，凑合看吧。"),l("a",{href:"http://velocity.oreilly.com.cn/2016/index.php?func=slidesvideos",target:"_blank",rel:"noopener"},"PPT 下载通道"),n("已经放出来了，感兴趣的可以自己跟踪一下。")],-1),l("h2",null,"UseThePlatform —— Web 组件介绍",-1),l("blockquote",null,[l("p",null,"分析者：来自 Youtube 的 Mikhail Sychev"),l("p",null,"感觉就是对 Polymer 和 Web Components 的科普。期待明天更详细的分享。"),l("p",null,[n("其实关于 Polymer，打开 Chrome 的 "),l("code",null,"chrome://downloads/"),n(" 查看源码，就能学到不少东西：CSS 变量、Shadow DOM、Polymer 等等。之前打算就这个写篇博客，一直没动手。")])],-1),l("p",null,"(略….)",-1),l("hr",null,null,-1),l("h2",null,"搜索引擎性能优化的未来 —— 搜索极速浏览框架",-1),l("blockquote",null,[l("p",null,"分享者：来自百度的陶清乾"),l("p",null,"听到最后才发现，原来是搞了套自己的后端工具，你“打开”的页面，可能只是百度缓存、处理过的。（免责声明：理解可能有偏差）还提了下使用的 工具 MIP。")],-1),l("h3",null,"全流程优化",-1),l("ul",null,[l("li",null,"展现交互"),l("li",null,"加载策略"),l("li",null,"页面渲染")],-1),l("h3",null,"框架解决问题",-1),l("ul",null,[l("li",null,"创建容器视图，提升交互体验"),l("li",null,"异步加载渲染，提升页面渲染速度"),l("li",null,"prefetch 实例，优化网络、服务开销"),l("li",null,"优化机制，优化细粒度模块速度")],-1),l("h3",null,"感知交互时间",-1),l("p",null,"点击搜索结果 => 页面响应",-1),l("h3",null,"加速原理",-1),l("h4",null,"传统页面",-1),l("p",null,"点击。连接。响应。基础渲染。内容渲染。组件加载。",-1),l("h4",null,"加速",-1),l("p",null,"点击 ",-1),l("p",null,"​ A => 交互响应。基础渲染。。。。",-1),l("p",null,"​ B => 连接。响应。 。。。",-1),l("p",null,"。。。。内容渲染、组件加载",-1),l("h2",null,"应用性能数据可视化",-1),l("blockquote",null,[l("p",null,"分享者：来自 mmTrix 的朱建锋"),l("p",null,"先是对可视化、性能等做了一些介绍，之后讲数据处理，科普了几种平均数，之后科普了各种常用的图（如雷达图、南丁格尔玫瑰图 etc.）。")],-1),l("h3",null,"前面",-1),l("ul",null,[l("li",null,"尽量使用抗干扰性更好的方法计算性能数据"),l("li",null,"标准差衡量性能标准")],-1),l("h3",null,"可视化是一个编码过程",-1),l("ul",null,[l("li",null,"基本的简单的图。"),l("li",null,"目的：表达数据。")],-1),l("h3",null,"请求理想时间小于 1s",-1),l("ul",null,[l("li",null,"DNS: 50ms"),l("li",null,"TCP shakes: 100ms"),l("li",null,"SSL(https): 300ms"),l("li",null,"Waiting for Response: 250ms（网络请求 => First Byte）"),l("li",null,"接收 Data: 300ms")],-1),l("hr",null,null,-1),l("h2",null,"Hulu 的 React / Redux 构架实践",-1),l("blockquote",null,[l("p",null,"分享者：来自“美国的爱奇艺” Hulu 的程墨"),l("p",null,"较基础，但对于 Constraints vs Conventions 相关的内容非常不错，很值得思考。")],-1),l("h3",null,"Challenges",-1),l("ul",null,[l("li",null,[n("System Complexity"),l("ul",null,[l("li",null,"Legacy code in jQuery & Backbone"),l("li",null,"UI non-predictable"),l("li",null,"Lack of component isolation")])]),l("li",null,[n("Performance Bottleneck"),l("ul",null,[l("li",null,"Initial AJAX roundtrip")])])],-1),l("h3",null,"Tech Stack",-1),l("ul",null,[l("li",null,[l("p",null,[l("strong",null,"Before"),n(": jQuery + Backbone + Ruby on Rails")])]),l("li",null,[l("p",null,[l("strong",null,"After"),n(": React + Redux + Node & Express")])])],-1),l("h3",null,"Other Notes",-1),l("ul",null,[l("li",null,[l("code",null,"React APP = Keep Rndering")]),l("li",null,[l("code",null,"UI = f(state)")]),l("li",null,"Constraints vs Conventions")],-1),l("hr",null,null,-1),l("h2",null,"数亿级用户规模下的 React Native 应用实践",-1),l("blockquote",null,[l("p",null,"分享者：来自百度的雷志兴"),l("p",null,"做过一段时间的 RN，所以基本能听懂。"),l("p",null,"其他的内容，个人感觉可算干货满满。没提到热更新。"),l("p",null,"结合此前 58 同城 RN、携程 RN 等文章一起看，会更好的哈哈")],-1),l("h3",null,"手机百度",-1),l("ul",null,[l("li",null,"迭代周期： 4周"),l("li",null,"主要 features：数十个"),l("li",null,"开发工时：数千人时"),l("li",null,"跨部门，沟通成本高"),l("li",null,"业务种类多，集成成本高"),l("li",null,[n("过去的解耦方案"),l("ul",null,[l("li",null,"APK 插件 / SDK"),l("li",null,"Hybrid")])]),l("li",null,"迭代速度：native 的 5-8 倍")],-1),l("h3",null,"RN 工程实践",-1),l("ul",null,[l("li",null,[n("与现有业务融合"),l("ul",null,[l("li",null,"Android 4.1 以上"),l("li",null,"v0.32 以上不支持 iOS 7"),l("li",null,[l("strong",null,"降级兼容"),n("：随时回撤；AB Test")]),l("li",null,[l("strong",null,"性能方面"),n(": 空间换时间，便利性换性能；减少重绘，减少通讯")]),l("li",null,"统一交互协议：RN 和 Native 相互之间的调用")])]),l("li",null,[n("融入迭代流程"),l("ul",null,[l("li",null,"首先，前提是业务方明确提出 RN 产品需求，明确哪些能够做到"),l("li",null,"容灾方案：报错率较高怎么办？"),l("li",null,"开发"),l("li",null,"发布：打包、测试后由 PM 从平台发布"),l("li",null,[l("strong",null,"监控"),n("：一定要能够监控到 RN 层，尤其是 js 层的报错信息（Note：坑！！！！！！！！）")])])]),l("li",null,[n("性能优化"),l("ul",null,[l("li",null,"通讯频繁 by design： js 足够的灵活性"),l("li",null,[n("易导致卡顿"),l("ul",null,[l("li",null,"事件频率高"),l("li",null,"js 运行时间长"),l("li",null,"UI 绘制频繁")])]),l("li",null,[n("初始化成本高"),l("ul",null,[l("li",null,"生成模块配置表")])]),l("li",null,[n("ListView 优化"),l("ul",null,[l("li",null,"View 无法复用，内存紧张"),l("li",null,"DOM diff： 大量重新渲染"),l("li",null,"业务层优化：预留空白单元；大量内容时重新渲染"),l("li",null,[l("strong",null,"解决 1"),n("：删除非可视区 View")]),l("li",null,[l("strong",null,"解决 2"),n("：模板复用（item 可能跳动、闪烁）")]),l("li",null,"建议：产品进行限制，超过一定数量时重新刷新")])]),l("li",null,[n("动画"),l("ul",null,[l("li",null,"16ms，容易丢帧"),l("li",null,"实验特性 userNativeDriver: true —— 将动画数据算好全部发给 Native，减少通讯")])]),l("li",null,[n("启动速度优化"),l("ul",null,[l("li",null,"预初始化：APP 启动后，立即 instance Init，用户点击的时候，就可以直接开始 js 业务"),l("li",null,"首页业务多，instance 初始化过多，开销太大。"),l("li",null,"单 Instance 多业务：Component 方法加载业务，无法使用 global"),l("li",null,"按需加载：公用部分在初始化时加载，业务部分在交互时才开始加载")])]),l("li",null,"延迟加载、渲染")])]),l("li",null,[n("跨端方案对比"),l("ul",null,[l("li",null,[n("RN 适用场景"),l("ul",null,[l("li",null,"超级 APP"),l("li",null,"体验平台级 APP")])]),l("li",null,"Hybrid：..."),l("li",null,"APK 插件：...")])]),l("li",null,[n("Summary"),l("ul",null,[l("li",null,"发版周期、开发成本和使用体验之间找到平衡"),l("li",null,"系统性工程：有机融入 APP"),l("li",null,"...")])])],-1),l("h3",null,"Q&A",-1),l("ul",null,[l("li",null,"h5 和 RN 迭代的问题：两端齐头并进，各自开发"),l("li",null,"Native Module 问题上报：...."),l("li",null,"非结构化 ListView 优化：RN 做的话，很难解决，结构样式尽量简单一些"),l("li",null,"RN 版本升级应对：RN 的 持续交付。。。")],-1),l("hr",null,null,-1),l("h2",null,"双十一 Weex 会场极致性能优化",-1),l("blockquote",null,[l("p",null,"分享者：阿里的冯成晓、周婷婷"),l("p",null,"终于面对面接触到 Weex 分享了。很久之前逢阿里面试官必问 Weex，想必他们烦极了。"),l("p",null,"和百度同学关于 RN 的分享两场一起听下来，真的收获多多。"),l("p",null,"印象非常好的一点是，分享过程中，反复提到 W3C 标准，提到希望补齐和 W3C 性能优化相关的 feature。这种思路应该是非常棒的。")],-1),l("ul",null,[l("li",null,[l("code",null,"f(HTML/CSS/JS) = Native UI")]),l("li",null,"DSL(HTML/CSS/JS) -> Virtual DOM -> Renderer -> UI"),l("li",null,"Transformer: DSL -> JS Bundle"),l("li",null,[n("JSFramework: DOM Tree"),l("ul",null,[l("li",null,"模板编译，数据绑定")])]),l("li",null,[n("Render：参照 Webkit"),l("ul",null,[l("li",null,"Build Tree"),l("li",null,"Compute Style"),l("li",null,"CSS Layout (… Reflow, Relayout)"),l("li",null,"Create View"),l("li",null,"Update Frame"),l("li",null,"Set View Props (… RePaint)"),l("li",null,"Native View")])])],-1),l("h3",null,"优化",-1),l("ul",null,[l("li",null,"下载 js： 预加载"),l("li",null,"执行 js：单 context 共享"),l("li",null,"解析 DOM： Node & Tree 解析结合"),l("li",null,"渲染 UI： List & 异步渲染（内存复用，只会渲染可见部分）"),l("li",null,"全局污染治理 + JSCore 内存管理")],-1),l("h3",null,"性能优化指标",-1),l("ul",null,[l("li",null,[n("秒开率：加载时间+首屏时间 < 1s"),l("ul",null,[l("li",null,"加载时间：js bundle 加载时间"),l("li",null,"...")])]),l("li",null,"Weex 会场页面数：1700+，占比 99.6%"),l("li",null,"主会场 FPS：低端机 53， 高端机58"),l("li",null,"动画、视频、直播、全景图都是 Weex")],-1),l("h3",null,"实战部分",-1),l("ul",null,[l("li",null,"列表过长，WebView 内存不好控制，容易 crash "),l("li",null,[n("加载 js bundle：本地 IO 最快"),l("ul",null,[l("li",null,"APP 启动，预先下载 js"),l("li",null,"长连接通道 Push"),l("li",null,"全量/增量，被动/强制更新结合")])]),l("li",null,[n("预加载使用策略"),l("ul",null,[l("li",null,"根据业务特性斟酌"),l("li",null,"1700 个页面，由相同模板自由组合变成的"),l("li",null,"模块化，小粒度缓存"),l("li",null,"原来：1600 * 55 = 93 M"),l("li",null,"模块 + 配置：1700 * 5 + 30 * 10 = 8.8 M"),l("li",null,"但是模块 +配置这样的秒开率低了 10%"),l("li",null,[n("业务个性化预加载，根据进入场景下载：类似 "),l("link",{preload:""})]),l("li",null,[n("preload & prerender："),l("ul",null,[l("li",null,"dns-prefetch"),l("li",null,"preconnect（DNS + TCP connect）"),l("li",null,"prefetch"),l("li",null,"subresources（depreciated）"),l("li",null,"preload"),l("li",null,"prerender")])])])]),l("li",null,[n("js 执行"),l("ul",null,[l("li",null,"安卓下 V8 解析 js 耗时"),l("li",null,"减少 bundle size：去重，分离，通用组件内置"),l("li",null,[n("减少 VDOM 更新"),l("ul",null,[l("li",null,"shouldComponentUpdate"),l("li",null,"pureRenderMixin")])])])]),l("li",null,[n("动态数据并行预加载"),l("ul",null,[l("li",null,"点击时直接请求，然后存储在 storage 中（文蔺注：这块儿好像可以参考手机 QQ 家校 or 兴趣部落 React 的优化的文章）"),l("li",null,"storage LRU 策略"),l("li",null,"首屏数据请求参数不固定？。。。"),l("li",null,"jsbundle 走本地，效果如何？。。。"),l("li",null,"优化效果 80% 以上")])]),l("li",null,[n("首屏 UI 渲染"),l("ul",null,[l("li",null,"使用 list 代替 scroller"),l("li",null,"尽量减少布局嵌套"),l("li",null,"首屏以外的模板延迟初始化"),l("li",null,"新方案：requestIdleCallback")])]),l("li",null,[n("最佳实践"),l("ul",null,[l("li",null,"尽量 prefetch"),l("li",null,"use list"),l("li",null,"cell 细粒度拆分"),l("li",null,"减少首次加载内容"),l("li",null,"减少 js 大小")])]),l("li",null,[n("工具"),l("ul",null,[l("li",null,"Xcode simulator"),l("li",null,"Safari 10 Remote Inspector")])]),l("li",null,[n("性能指标优化流程（图）"),l("ul",null,[l("li",null,"发布基线"),l("li",null,"预发检测"),l("li",null,"线上监控"),l("li",null,"生成报表 <=== 业务达标基线"),l("li",null,"问题分析"),l("li",null,"开发修复"),l("li",null,"预发检测"),l("li",null,"。。。。")])]),l("li",null,[n("Week 下一阶段"),l("ul",null,[l("li",null,"W3C 性能优化 feature 补齐"),l("li",null,"性能 profile"),l("li",null,"完整开发模式"),l("li",null,"更丰富的交互体验"),l("li",null,"更丰富的 module 和 component")])])],-1)])]),_:1})}}};export{m as default};
